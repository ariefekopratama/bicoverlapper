S=Solved
D=Discarded (existing but decided not to solve by now, because it's minor or irrelevant)
->=To do

-> Reformatting old data
	Expression
		DONE Ecoli -> didn't work because the load method didn't take account of experiments without EFVs, now it does
		CURATE Hsapiens -> load but must be curated 
		
--> Curating old data	
		Ecoli	Can put just one digit, but irrelevant
		H.sapiens Log transform, maybe better take any other experiment (this one is pretty bad)
		

CC PC scrolls should read actual expression values
-> Matrix size can mangle R processing, at about 5M of file... -> reduce the number of decimal digits if possible.
- Check GSEA.R on KEGG.db
-> WordCloud still hangs up from time to time... and it never takes profit of the total window size...
     It totally frozens the view!!
-> explore GEOquery for importing experiments
	S R code ready (downloadGEO method in downloadAndNormalize.R)
--> KEGG path annotations, make it work
--> Overlapper perfomance downgrades the system grows with groups (E-GEOD-17636, only diffexp with limma, 2 groups, with PC, WC and O) -> it also happens with BM, something is downgrading there the system a lot!
		It's not always... keep checking
--> Changing labels removes selection (just sometimes... investigate)
S Column selection: after a selection, we should restore the original order before taking a new one? If not it's confusing
	S in PC, lose the scrolls after!
	S in HM
--> Several issues keep arising on HM and PC with deep interaction...	
--> Deselection after changing options on WC
--> Link hovered node (highlight its words in the WC too)
		S WC highlighting done (maybe too much, not sure if keeping it)
S TRN Expression color scale does not correspond to the one in the HM -> The ExpressionColorAction was numerical, and it was rebuilt after an update
-> Progress bars:
	S Download from AE
		S Also solved some problems with non-alphanumeric EFVs and column names, with which R had problems
	S Percentiles in PC (load matrix into R)
	Clearer status in WC
S Caps+click halves heatmap width
	A matter of adding again the whole number of conditions, doubling the elements
	S Ctrl+click has the same problem! 
	
	

-> Merge rows? based on entrez id or symbol?
-> Time performance (s) in R load and retrieving of annotations (ga: only entrez id and symbol)
	Organism (rows)				load	ga		go	
	S. cerevisiae (6400 rows)	5		0.7		8
	H. sapiens (54000 rows)		9		4		210
	Broad go term search remains unrealistic on the current terms, but if we go to R, the times are:
	H. sapiens (54000 rows)		-		3		36
	So we are adding huge amounts of time with java wrapping:
	1) If we read less than all the elements (but a lot) it goes thru a large string construction that takes about 70s
	
			
S Synchronization on loadMatrix
-> Synchronization on geneAnnotations search
S Avoid re-searches for GO terms if we haven't found any for a first time
	But still, if word cloud is open, it re-searches for the selected genes!
		S Avoided if every gene has been searched for
		-> Still, if some genes in the selection has been searched for and some others not, it will search for the whole of them
S Invalid memory access of location 0x10 rip=0x11f90731e during diffExp analysis
	It looks like something related with the new R 2.13 version...that installation is running not very well in Eclipse too
	Some other analyses (correlation building, annotation retrieval) work ok
	But others work wrong (biclust, gsea)
	It looks like it's a problem of Eclipse with the latest java version for Mac (!) --> http://blog.abelmuino.com/2010/07/snow-leopard-java-y-invalid-memory-access-of-location.html
	It's a problem (at least partially) of getting the rj library for the proper version from http://www.walware.de/?page=/it/downloads/index.mframe
	S It's actually a problem from a R 2.13 bug, solved if a patched version (jul11) is installed!
-> Annotation retrieval
	Should be in background always. It can be ok in some organisms, but for human, for example, it takes very long (>1min)
		It's also a problem of bad programming trying to do a superbig string to pass to R --> solved this, it takes for humans <20s.
		Still too much, maybe.
		We reduce times by getting only symbol and entrez (no ensembl or description) -> 4s for human (50000probes)
	...
-> test some RNAseq data... include ArrayExpressHTS for its preprocessing?
S WC hangs after adding the words in addWords(), no apparent reason. It was because of drawing several times because of different WC windows
	or quick changes on selection, because of concurrency -> solved by making drawsWords synchronized
	 S if nothing is significant after a hypergeometrics test report
	 -> selection deselect when changing WC options
	 S heatmap color scale changes when changing options everywhere
	 
	 
S explore topGO for GO enrichment analysis, maybe easier/quicker than current method
	No, it sucks. Gostas is much better
S Correlation Network seems not to work again
	It's a problem of the standard deviation thing. I think it's counterintuitive, I changed it by basic filters. -> no! it's good, if not only housekeeping genes are set, reset and solved
S WC Search for word clicking on tag cloud
		S Done for current selection
		S For the whole gene set, pressing Ctrl, implemented, but it takes time and a progress bar could be good
S WC label with number of annotations retrieved
S Improve limma analysis (models were not used at the best model configuration)
  S Remove "rest" option from limma analysis: counter-intuitive, the option can be done by the rest of options, difficult to implement with the new model

Luis input
	S PC Change scolls colors
	S PC Reset scroll positions
	S Computing percentiles task bar not static
	-> Normalize every set (pre-process option in analysis?)
	
--> Revise the R package installation (especially annotation packages)
	S It seems to work perfectly well on mac
	--> Recheck on Windows and Linux, make installers
	-> Set installation of R2.13 and rJava as a requirement
S Generate Mac install package
	-JarBundler+PackageMaker OK
	
	-Recheck example data (in source code):
		S Brain -> NullPointerException: column ids starting with numbers... shall I leave this? -> Age as EF...
					S for column ids (must be always present so a single if is enough)
					->S detected and duely reported to the user in the case of Efs, but totally numeric EFVs not supported by now
		S EColi -> S They look ok, but bimax, isa did not run correctly, S also correlation network computation
					S It was a sideback problem, now fixed, and no longer GeneNames, but biomaRt.external.gene_id
		S Yeast -> NA values, now properly detected and displayed
					S Also, I have imputed them manually and changed it
		S Spombe -> S Search for gene names: annotations are retrieved online, so it's quite possible gene annotations are not ready still
					S GeneName is something to remove, too slow, too consuming, biomaRt.external_gene_id is much better!
		 
	-Recheck example data (in installed app):
-> NA values support and imputation
-> Numeric EFV support (read, numeric selection and merging)
	It will require changes on EF names, so we will specify they are EFs (EF.)
	S Read
	
S Add trick box with:
	Alt+Click on a gene on Parallel Coordinates or Heatmap opens up its NCBI webpage (if found)
	Right-click on Parallel Coordinates or Heatmap opens up a configuration panel for their visualizations
	Shift+Click add up to current selection instead of setting a new selection
	Ctrl+click on a gene on the Heatmap or Parallel Coordinates search for and selects similar profiles
	On Parallel Coordinates, you can select profiles by threshold dragging the tiny scrolls at the ends of each coordinate
	Ctrl+drag scrolls on Parallel Coordinates selects only by this scroll, resetting any other scrolls
	Ctrl-Z and Ctrl-Y can be used to go back and forth among selections
	Ctrl-0 can be used to remove any selection done
	Ctrl-F opens up the search box
	Ctrl-L opens up the label selection box
	Ctrl-S opens up the column sort box
	Pressing "u" on Overlapper shows/hides every gene on the groups
	Pressing "p" on Overlapper pauses/resumes the animation
	You can drag a line on Overlapper to select the genes that fall inside it
	You can use biomaRt.id_type as "chip" type, and gene annotations will be searched via BiomaRt (id_type can be, for example, "external_gene_id" or "entrezgene", and should match with row names, and be available as a filter for the species mart on biomaRt bioconductor package)
	You can use any Bioconductor annotation package names as chip info, for example org.Sc.sgd.db or hgu95av2.db (row names should be valid ids for that platform)
	 
	
	
S Color change of the heatmap after opening config box on PC	
	
S PC Boxplots restriction to width, sometimes too large if only a few columns shown
	S Label for hovered gene should not collide with first boxplot
S HM condition label restriction to width, somtimes too large if only a few columns shown
S Merge Columns: save EF by which the merging is done
- Download from AE: Check different experiments: currently ArrayExpress() only works for raw data from 96% of platforms...
		- Progress bar
		- Testing with simple, 4 samples, MEXP, Sc experiments:
		- E-MEXP-328, 1498 works (YGS98)
		- E-MEXP-2678 works (Yeast_2)
		
		- E.MEXP-906		-> ArrayExpress R package
		- E-MEXP-919 fails  -> ArrayExpress R package
--------
-> Session one session per microarray data load is working fine, except for the related R matrix. We can only have one console, so only the last R matrix is running.
			S we should solve that with several R matrix with different names.
			Now it loads and separates perfectly (on R and on Java level different sessions with different data, all with a single R console but storing different R matrices
			S Biclustering/TRN results titles wont's go to the active working desktop but to the first one (however results are perfectly loaded)
			-> Diselect menu options depending on the active workshop --> BicOverlapper.initDesktop
			-> In the end, proper control of changes between tabs.
S GSEA and DEA only work if you have replicates... -> allow GSEA-like analysis just with profile selection? workaround for limma/gsea to work with a single replicate
		The best way is to provide a method of merging samples by EF, and then apply GSEA.
D Sort: numeric problem -> there's a walkaround if resorted by the columnID
-> Overlapper: towards a drastic simplification of the view:
		- Exhaustive checking for bugs
		- Optimize forces (+- done)
		S Remove/simplify options bar
		S Display by default dual node setting
		S Selection of groups on dual node setting
		S Selection of groups with line drawing
		S Drag dual nodes
		S Not to show gene/cond labels if not asked for it
		S Show bicluster names by default?
-> Overlapper: zoom: almost solved but there's still some displacement 
S Analysis.loadMatrix now computes median, quantiles and outliers (it is used by now only by PC.drawBoxplots)
S PC now have the option to draw boxplots
S Bicluster filtering problems solved
S Check if analysis are working after change from m to eset: everything fine except for isa and bimax
S Move all the biclustering options to a single entry, then submenu
----
S Remove License and Help panel by web browser
D Remove Bubble map -> let's keep it by now
-> Option to write report with what's done (Juantxi)
-Shift+click in selection narrow the columns! (HM)
S GSEA encapsulated. Problem due to lmPerGene factor.
     S I solved it by dividing the method in two. Now I solved it to a single one!
     S Make it combinational, by now, EFV vs EF and EFV vs rest
S Different stored favorite paths for networks, groups and matrices
-> Something+click on a gene -> go to ncbi webpage searched by that gene. Via www.ncbi.nlm.nih.gov/gene/entrezID
	S: Done for HM, PC in alt+click. Method is MicroarrayData.browseEntrezGene
	-: Need to be done for N and O, at least (wordcloud for go terms?)
	By now:
	 -click for new selection (all except WC and PC)
	 -drag for new selection (PC)
	 
	 -shift+click is to add to selection (O, N, HM)
	  
	 -right click to show additional info (O) -> it will better become go to EntrezGene webpage for the gene (O,HM,PC,N)
	 -ctrl+click to get similar profiles (HM)
	 -ctrl+drag for selection having into account only this threshold (PC)
	 
	  -Right click on background to get visualization options (HM, PC)
	  
S Session - After closing a dataset, the program freezes when opening a new one.
				It was because we tried to reopen R console. Only one console will be running, despite of the number of datasets opened
S Data - MAPK1 (ENSG00000100030) fails when retrieving its go terms via biomaRt.
		Solved, there was a problem with single gene search, that returned a matrix instead of a list
S Analysis - differential expression analysis. Close to solution.
			S 1) Done efv vs efv
			S 2) Done ef vs efv
			S 3) Not done ef vs ef
S Data - 	Direct download from ArrayExpress (raw) + process it and save in the BicOverlapper format.
Data - 		One step beyond, direct download and preprocessing of several experiments, either by ID list or by descriptive name!

		Currently, MicroarrayData are replicated in a double[][] and in a R matrix everytime we call R for something. That can be very memory consuming, maybe we
		should remove the java matrix and access only the R matrix --> That's a huge redesign.
		Right now, it works well for 300 000 expression levels, and slow for about 10e6, but it renders unusable for 3*10e6 (on a 2GHz, 3G RAM machine)
	   Check, when we load groups or networks, and there is an expression matrix loaded, if the genes matches and throw a warning window if not. 
Install - make installation as easy as possible, especially with the R thing
Config - it should save also the dimensions of the general window
		 it sometimes does not load properly, i don't know why.
BN (Config) - do not recompute forces everytime it goes to ok, only when "Change Forces" it is actually pressed 
HM - the search for neighbor profiles takes about 10s for a yeast array... get a thread like in the hypergeometric case
Annotation - Names are not properly retrieved on the second load for a microarray
BN (former TRN): Be able to stop the animation of expression
				Names fucked up after a second showLabels
TRN: Add another view with biological pathways, not loaded but obtained from KEGG or elsewhere. An intermediate window will be needed to select the pathway. 
	 It will be highly static in the best of the cases, I think.
PC, HM -> Sort columns by different EFVs. Exhaustive check on PC, Errors in HM
			HM condition labels work in selection of biclusters but not in sorting. The opposite for expression levels.
				S condition labels now work in sorting and bicluster selection. If they are sorted and then a bicluster is selected, the columns not in the bicluster still keep the sorting
				S About expression levels, now they work on sorting but not in expression levels, so we had leveled off their behavior with the ones of labels.
			PC if columns are sorted and then a bicluster is selected, the sorting is not kept.
			S HM initial sorting for the whole matrix (only worked for selected biclusters, and labels). Now solved

PC S -> when resize: lines get out of limits, or limits shrink: solved, and data computations moved to the MicroarrayData class

BicOverlapper -> High dimensionality matrices. I'm trying with our merging, with ~50000x70, and experiencing several troubles.
				S It's specially because of the bad use of resources on parallel coordinates, that has been to some extent reduced. 
					PC now works really smooth for a 50000x70 example, with an initial time of about 3s and then almost real time. The mayor problem that PC may have above this number if the 
						screen space is small for so many axes. For 70 axes, with a 1920x1200 screen there's still space for about another 30 or so, and to be readable. For more, we will need to 
						filter out on demand.
				-> Also, the heatmap surpasses java heap space. Using Sizeof, i have around 30M reserved when I start reading a microarray data.
					For a ~10000x17 matrix, it ends the reading with 70M. I can save about 15M if I then run GC
					For a ~50000x67 matrix, it ends the reading with 950M. I can save about 250M if I then run GC, which is really important
					The max memory allowed is 1024M, so it's very close, although supposedly not too much additional memory will be needed.
					Actually, there are some methods, like properly choosing the color scale, that need matrices almost as large as the original, which makes
					the memory grow a lot. In this case, setting the max to 2048 we can see the whole matrix (with a lot of delay on times, but then nicely interactive), and
					the memory grows to 1.86GB. After the initial draw, you can perfectly work with it if you put a maximum or 2048
				S WC works pretty well after the different improvements done
				Biclustering: it seems that it is too much, probably R surpasses the memory limit with these examples
				
Project -> save several new things, such as:
				sorting, 
				labels shown, 
				S wc configuration of indices
				etc.
load project Should save the last location. Recent projects should take into account the last opened, not only the last saved.
				 
S WC -> Word scale in the case of hypergeometric tests doesn't look very well, it gives too much size gap between orders of magnitude.				

Overlapper -> Deseleccionar en todas las vistas cuando se deselecciona
				Deseleecionar en todas las vistas cuando se deselecciona uno de entre varios en overlaper

WordCloud -> Seleccionar GO terms... estudiar escalado

PC -> Profile hovering, selection DONE
      Remove hovering when going out of the focus of the PC window
      Pass hovering to other views.
				
17	PC	Slopes para selección?	Implementado, falta checkeo exhaustivo. Slopes para m'as de una condicion a la vez?

->67	Opt	Chequear la disponibilidad de las opciones de menú en todos los casos. Bien, salvo que a veces cuando falla la carga no cierra el cuadro de carga, ni permite cerrarlo
			->Al cargar un nuevo microarray, deberían deshabilitarse hasta que esté cargado (se habilitan porque corre el hilo de manera asíncrona y error es siempre true!
->73	Bic	Chequeo completo del análisis de biclustering
				Format error al leer los que se guardan de xmotifs
				S Interfaz de filtrado en todos
82	Text	Ventana con toda la información en modo texto de la selección actual: niveles de expresión, nombre, anotaciones, etc.	
83	Select	Selección solo de condiciones dibuja en blanco heatmap (debería también resetear scrolls en pc).
			Parece que es solo a veces...

68	PC	Error en scrolls al modificar tamaño de ventana
			Es al modificar en vertical, si se añade horizontal al final queda bien
			No es siempre, así que parece un tema de actualización desincronizada
->47	PC	Actualizaciones en general, chequeo completo
				S Selección de biclusters no coloca poligonos de fondo
71	HM	Tras seleccionar bicluster: 
			Al hover de condiciones q no están en el bicluster (con las etiquetas) -> muchas veces se seleccionan 2
			Al hover de expresiones-> como hover de condiciones
			S Al hover un gen no distorsiona las columnas seleccionadas
56	HM	Recuadritos para los niveles de expresión?
60	OV	Seleccionar clusters cuando se ha filtrado
65	OV	Etiquetas siempre encima (selecciones)
		S Mejorar legilibilidad de hover node -> He incrementado su anchura a 2, mientras que para seleccionados está a 3.
		Revisar threshold limits
55	Gen	Retirar del todo el tema MultidimensionalData
61	Layers	Selección PC+Navegación OV, con BM abierto. PC deja de marcar la selección
62	R	Adquisición de R... a veces no lo coge aunque debería tenerlo?
66	Err	Gestión y explicación de errores durante la carga de microarrays/biclusters/trns
		Cargas fallidas de R cuando sí que está correctamente instalado
		Wrong format: empty sample name(s)

D 78	TRN		Limitar la visualizacion a unos cuantos vecinos de los genes seleccionados. Muy interesante, pero con tiempo
D 74	Data	Tratamiento de NAs? En PCs deberían tratarse como un segmento que falta y en Heatmap como un recuadro en gris. Tendrían que venir en el fichero de entrada como NA
D/S 80	Anotaciones	La barra de progresos de anotaciones es coñazo, sobre todo con navegación overlapper, reparar para q no se llama cuando no debe
					S Navegación en Overlapper ya no vuelve a llamar a update.
					S Voy a quitar la barra y a sustituirla por una pequeña etiqueta de texto. Queda muchísimo mejor
					D Voy a probar el update on the fly, según se vayan consiguiendo las anotaciones. De momento no merece la pena
->44	S/D OV	Zoom: arreglar o quitar. Hay que arreglar
				S Dibujado de nodos en los bordes
				S Línea de selección de nodos. Empieza en algún lugar lejos al top-left 
				S Hover por hulls funciona pero selection no
				S Cuadro de navegación mal situado
				S Drag nodes no funciona (misma razón que el comienzo raro de la línea de seleccion
				S Puesto como mouse wheel action
				D Durante el zoom hay un desplazamiento que no sé si realmente se puede evitar
S/D 12	HM	Chequeo exaustivo
		Etiquetas diagonales
			S/D c) Que queden bien al distorsionar -> parece que también le falta la suma de la anchura del bounds...
			   Hago modificaciones para que esto no dependa de posiciones sino de identificadores, para evitar problemas en posiciones muy fronterizas y adquirir un mayor control
			   cambio el BifocalDistortion por un HeatmapHoverControl y comunicacion con MicroGridLayout, etc.
			   Las modificaciones hacen que el hovering quede mejor, pero aún hay varios temas:
			   	S c.1)	La distorsión de las etiquetas es distinta de la de los cuadrados de expresión, la mínima queda un poco más pequeña y a la larga las etiquetas ocupan menos que los cuadrados
			   			Ocurría en hover porque utilizaba el número de genes/cond seleccionadas en vez de el número de genes/cond sobrepasadas
			    D    c.2)	Extraño efecto al hover la primera etiqueta de condicion, que se va para adentro
			    D/S   c.3)	Ahora mismo, o hover o selección, si está hecha una selección no se permite el hover. Hecho pero:
			    		* S Con una columna seleccionada, paso del hover de la primera columna a la segunda (igual con filas)
			    		* S Distorsión de etiquetas cuando hover tras selección. Hecho para genes y condiciones
			    			S - Selección de la primera condición no seleccionada cuando hay una condición seleccionada sale mal (distorsiona a una dimensión mayor de la máxima la anchura)
			    		* S Hover del gen seleccionado distorsiona otro distinto!
			     		* D Rayicas blancas que a veces salen
			 
